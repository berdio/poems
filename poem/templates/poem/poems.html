{% extends 'base.html' %}

{% block content %}
<div class="container">

<h1 class="text-center">Poems</h1>
    <form class="input-group rounded" action="{% url 'poems' %}" method="get">
        <input id='search' type="search" class="form-control rounded" placeholder="Search" value="{{search}}" aria-label="Search"
        aria-describedby="search-addon" name="search" />
        <span class="input-group-text border-0" id="search-addon">
        <button type="submit" value="Search"><i class="fa fa-search"></i></button>
        </span>
    </form>
    <table class="table">
        <thead>
            <th>Author  
                {% if sort_by_author == 'asc' %}
                <i onclick="sortByAuthor('desc')" class="bi bi-sort-up"></i>
                {% else %}
                <i onclick="sortByAuthor('asc')" class="bi bi-sort-down"></i>
                {% endif %}
            </th>
            <th>Title  
                {% if sort_by_name == 'asc' %}
                <i onclick="sortByName('desc')" class="bi bi-sort-up"></i>
                {% else %}
                <i onclick="sortByName('asc')" class="bi bi-sort-down"></i>
                {% endif %}
            </th>
        </thead>
        <tbody>
            {% for p in poems %}
            <tr>
                <td>{{p.author.full_name}}</td>
                <td><a href="/poems/{{p.id}}">{{p.name}}</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
function sortByAuthor(order) {
    var search = document.getElementById('search').value
    location.href = '{% url "poems" %}?sort_by_author=' + order + '&sort_by_name=' + '{{sort_by_name}}' + '&search=' + search;
}

function sortByName(order) {
    var search = document.getElementById('search').value
    location.href = '{% url "poems" %}?sort_by_name=' + order + '&sort_by_author=' + '{{sort_by_author}}' + '&search=' + search;
}
</script>

{% endblock %}